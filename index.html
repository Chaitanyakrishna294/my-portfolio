<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaitanya Krishna Reddy - Portfolio RPG</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        :root {
            --bg-color-light: #87CEEB; --bg-color-dark: #000020;
            --ground-color-light: #4CAF50; --ground-color-dark: #1A2A3A;
            --text-color-light: #000030; --text-color-dark: #E0E0E0;
            --window-bg-light: rgba(255, 255, 255, 0.7); --window-bg-dark: #000030;
            --border-color-light: #000030; --border-color-dark: #E0E0E0;
            --secondary-text-light: #1c3d5a;
        }
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: var(--bg-color-dark);
            color: var(--text-color-dark);
            text-shadow: 2px 2px #000000;
            transition: background-color 0.5s ease;
            overflow-x: hidden;
        }
        /* --- THEME SWITCHING --- */
        body.light-mode {
            background-color: var(--bg-color-light); color: var(--text-color-light); text-shadow: 1px 1px rgba(255,255,255,0.5);
        }
        body.light-mode .window-box {
            background-color: var(--window-bg-light); border-color: var(--border-color-light); color: var(--text-color-light);
        }
        body.light-mode .secondary-text { color: var(--secondary-text-light); text-shadow: none; }
        body.light-mode #header { background-color: var(--bg-color-light); border-bottom-color: var(--border-color-light); }
        body.light-mode .btn-morph span { color: #000; text-shadow: 1px 1px #FFF; }
        body.light-mode .btn-morph .top { background: #FF00FF; border-color: #000; }
        body.light-mode .btn-morph .bottom { background: #e600e6; }
        body.light-mode footer { border-top-color: var(--border-color-light); }
        body.light-mode #game-ground { background-color: var(--ground-color-light); }
        body.light-mode .project-card { background-color: rgba(255,255,255,0.5); color: var(--text-color-light); }
        body.light-mode #char-dark, body.light-mode #dark-scenery { display: none; }
        body.dark-mode #char-light, body.dark-mode #light-scenery { display: none; }
        body.light-mode .mushroom { display: none; }
        body.dark-mode .flower { display: none; }

        /* --- INTRO & GAME OVER SCREENS --- */
        #intro-screen, #game-over-screen {
            position: fixed; inset: 0; background-color: #000; z-index: 100;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: white; transition: opacity 0.5s ease-out;
            padding: 2rem; text-align: center;
        }
        #intro-screen.hidden, #game-over-screen.hidden { opacity: 0; pointer-events: none; }
        .blinking-text { animation: blink 1s infinite steps(1, start); }
        #loading-bar-container { width: 80%; max-width: 400px; height: 20px; border: 2px solid #00FFFF; margin-top: 1rem; }
        #loading-bar { width: 0%; height: 100%; background: #00FFFF; transition: width 0.5s ease-out; }

        /* --- GAME BACKGROUND & CHARACTER --- */
        #game-background { position: fixed; inset: 0; z-index: -10; overflow: hidden; }
        #game-ground { position: absolute; bottom: 0; left: 0; width: 100%; height: 50px; background-color: var(--ground-color-dark); transition: background-color 0.5s ease; z-index: 5; }
        #main-character { position: absolute; bottom: 50px; left: 5%; width: 80px; height: 80px; transition: left 0.1s linear, transform 0.3s ease-out; will-change: left, transform; image-rendering: pixelated; z-index: 10; }
        #main-character.jumping { animation: jump-anim 0.6s ease-out; }
        @keyframes jump-anim { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-100px); } }
        #main-character img { width: 100%; height: 100%; object-fit: contain; }
        .scenery-layer { position: absolute; inset: 0; transition: transform 0.1s linear; animation: float-anim 8s ease-in-out infinite; }
        .scenery-item { position: absolute; bottom: 50px; }
        .cloud { animation: drift 60s linear infinite; }
        @keyframes drift { from { transform: translateX(-200px); } to { transform: translateX(100vw); } }
        .ground-item { position: absolute; bottom: 20px; width: 20px; height: 30px; }
        @keyframes float-anim { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* --- WEATHER EFFECTS --- */
        #weather-layer { position: fixed; inset: 0; z-index: -9; pointer-events: none; }
        .sun { position: absolute; top: 10%; right: 10%; width: 100px; height: 100px; background: #FFD700; border-radius: 50%; box-shadow: 0 0 50px #FFD700; }
        .star { position: absolute; width: 2px; height: 2px; background: white; border-radius: 50%; animation: twinkle 2s infinite; }
        @keyframes twinkle { 50% { opacity: 0.5; } }
        .rain-drop { position: absolute; bottom: 100%; width: 1px; height: 50px; background: linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,0.5) 100%); animation: fall 1s linear infinite; }
        @keyframes fall { to { transform: translateY(100vh); } }

        /* --- COLLECTIBLES --- */
        .collectible { position: absolute; width: 40px; height: 40px; z-index: 6; transition: transform 0.3s, opacity 0.3s; }
        .collectible.collected { transform: scale(2) rotate(360deg); opacity: 0; }

        /* --- SPECIAL EFFECTS --- */
        #ai-powerup-display { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; pointer-events: none; z-index: 50; opacity: 0; }
        #ai-powerup-display.show-powerup { animation: powerup-anim 1.5s ease-out; }
        @keyframes powerup-anim { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 0; } }
        .power-up-particle { position: fixed; width: 8px; height: 8px; background-color: #FFEB3B; border-radius: 50%; animation: fade-out-up 0.5s ease-out forwards; z-index: 20; }
        @keyframes fade-out-up { from { transform: translateY(0) scale(1); opacity: 1; } to { transform: translateY(-30px) scale(0); opacity: 0; } }
        .screen-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }
        .char-is-changing { animation: mode-change-effect 0.5s ease-in-out; }
        @keyframes mode-change-effect { 0% { transform: scale(1) rotate(0deg); opacity: 1; } 50% { transform: scale(0) rotate(180deg); opacity: 0; } 100% { transform: scale(1) rotate(360deg); opacity: 1; } }
        .skill-icon:hover { animation: skill-pulse 0.5s ease-in-out; }
        @keyframes skill-pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        .project-card:hover { animation: project-shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes project-shake {
            10%, 90% { transform: translate3d(-1px, 0, 0) rotate(-1deg); }
            20%, 80% { transform: translate3d(2px, 0, 0) rotate(2deg); }
            30%, 50%, 70% { transform: translate3d(-3px, 0, 0) rotate(-2deg); }
            40%, 60% { transform: translate3d(3px, 0, 0) rotate(2deg); }
        }

        /* --- INTERACTIVE BUTTONS --- */
        .btn-morph {
            position: relative; border: none; background: transparent; padding: 0; cursor: pointer;
            outline-offset: 4px; transform-style: preserve-3d;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .btn-morph span { display: block; position: relative; padding: 12px 24px; text-shadow: 2px 2px #000; }
        .btn-morph .top {
            background: #FF00FF; border: 4px solid #FFFFFF; transform: translateY(-8px);
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .btn-morph .bottom {
            position: absolute; inset: 0; background: #cc00cc; transform: translateY(0px) translateZ(-4px);
            border: 4px solid #FFFFFF; clip-path: polygon(0 8px, 100% 8px, 100% 100%, 0 100%);
        }
        .btn-morph:hover .top { transform: translateY(-12px); }
        .btn-morph:active .top { transform: translateY(-4px); }

        /* --- GENERAL STYLES --- */
        .window-box { background-color: var(--window-bg-dark); border: 4px solid var(--border-color-dark); box-shadow: 6px 6px 0 #000000; transition: background-color 0.5s, border-color 0.5s; }
        .typed-cursor { animation: blink 0.5s infinite steps(1, start); }
        @keyframes blink { 50% { opacity: 0; } }
        .fade-in-section { opacity: 0; transition: opacity 0.5s ease-in; }
        .fade-in-section.is-visible { opacity: 1; }
        #header { background-color: var(--bg-color-dark); border-bottom: 4px solid var(--border-color-dark); transition: background-color 0.5s, border-color 0.5s; }
        footer { border-top: 4px solid var(--border-color-dark); transition: border-color 0.5s; }
        .skill-bar-container { display: flex; gap: 4px; }
        .skill-block { width: 10%; height: 20px; background-color: #444; border: 2px solid #000; }
        .skill-block.filled { background-color: #00FFFF; box-shadow: inset 2px 2px #FFFFFF, inset -2px -2px #00AADD; }
        .project-card { border: 4px solid var(--border-color-dark); transition: transform 0.2s ease, box-shadow 0.2s; }
        #ai-chat-box { height: 300px; background-color: #000010; border: 2px solid #00FFFF; padding: 10px; overflow-y: auto; margin-bottom: 1rem; line-height: 1.5; }
        #ai-chat-box p { text-shadow: none; display: flex; align-items: flex-start; }
        #ai-input { background-color: #000010; border: 2px solid #00FFFF; padding: 10px; width: 100%; color: #E0E0E0; }
        #ai-input:focus { outline: none; border-color: #FF00FF; }
        body.light-mode #ai-chat-box { background-color: #f0f8ff; border-color: var(--border-color-light); color: var(--text-color-light); }
        body.light-mode #ai-input { background-color: #f0f8ff; border-color: var(--border-color-light); color: var(--text-color-light); }
        body.light-mode #ai-input::placeholder { color: var(--secondary-text-light); opacity: 1; }
    </style>
</head>
<body class="dark-mode">

    <!-- Intro Screen -->
    <div id="intro-screen">
        <div id="terminal" class="text-left text-sm md:text-base w-full max-w-lg">
            <p>&gt; CKR_PORTFOLIO.EXE</p>
            <p id="loading-text">&gt; INITIALIZING...</p>
            <div id="loading-bar-container"><div id="loading-bar"></div></div>
        </div>
        <button id="intro-start-button" class="text-2xl md:text-4xl blinking-text mt-8 hidden">PRESS START</button>
    </div>

    <!-- Game Background -->
    <div id="game-background">
        <div id="weather-layer"></div>
        <div id="light-scenery"><div id="clouds" class="scenery-layer" data-speed="0.1"></div><div id="light-trees" class="scenery-layer" data-speed="0.3"></div></div>
        <div id="dark-scenery"><div id="mountains" class="scenery-layer" data-speed="0.2"></div><div id="dark-trees" class="scenery-layer" data-speed="0.4"></div></div>
        <div id="main-character">
            <img id="char-light" src="dark.png" alt="Light Mode Character">
            <img id="char-dark" src="red.png" alt="Dark Mode Character">
        </div>
        <div id="collectible-layer"></div>
        <div id="game-ground"><div id="ground-details"></div></div>
    </div>
    
    <!-- UI Elements -->
    <div id="ai-powerup-display"></div>
    <button id="jump-button" class="fixed bottom-4 right-4 z-50 btn-morph md:hidden !p-0"><span class="top !p-4">JUMP</span><span class="bottom"></span></button>

    <!-- Header -->
    <header id="header" class="fixed top-0 left-0 right-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold secondary-accent-color">CKR_</div>
            <div class="hidden md:flex space-x-4 items-center text-xs">
                <a href="#about" class="nav-link">&gt; ABOUT</a>
                <a href="#projects" class="nav-link">&gt; PROJECTS</a>
                <a href="#skills" class="nav-link">&gt; SKILLS</a>
                <a href="#ai-sidekick" class="nav-link">&gt; AI_SIDEKICK</a>
                <a href="#contact" class="nav-link">&gt; CONTACT</a>
            </div>
            <div class="flex items-center">
                <button id="theme-toggle" class="p-2"><i data-feather="sun" class="text-white"></i><i data-feather="moon" class="text-white hidden"></i></button>
            </div>
        </nav>
    </header>
    
    <!-- Main Content -->
    <main class="container mx-auto px-6 pt-24 relative z-10">
        <section id="hero" class="min-h-screen flex items-center justify-center text-center">
            <div>
                <h1 class="text-lg secondary-accent-color mb-4">LOADING PROFILE...</h1>
                <h2 class="text-3xl sm:text-4xl md:text-5xl font-black leading-tight">CHEVURU CHAITANYA<br/>KRISHNA REDDY</h2>
                <h3 class="text-lg sm:text-xl md:text-2xl font-black mt-4"><span class="accent-color">&gt;</span> <span id="typing-text"></span><span class="typed-cursor">_</span></h3>
                <p class="mt-8 max-w-xl mx-auto secondary-text text-xs md:text-sm">SYSTEM.OUT.PRINTLN("A Computer Science student specializing in backend dev, AI, and cloud solutions.");</p>
                <div class="mt-10"><a href="#about" id="start-button" class="text-2xl md:text-4xl blinking-text cursor-pointer hover:text-accent-color transition-colors">PRESS START</a></div>
            </div>
        </section>

        <section id="about" class="py-20 fade-in-section">
            <div class="window-box p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 accent-color">PLAYER_INFO.TXT</h2>
                <div class="space-y-4 text-xs md:text-sm secondary-text leading-relaxed">
                    <p>&gt; Hello! I'm Chaitanya, a B.Tech Computer Science student at VIT, Chennai.</p>
                    <p>&gt; My main quest is to build robust and intelligent systems...</p>
                    <p>&gt; I am currently exploring the dungeons of cybersecurity, scalable systems, and emerging technologies.</p>
                    <p>&gt; SIDE QUEST: Drawing and sketching.</p>
                </div>
            </div>
        </section>
        
        <section id="education" class="py-20 fade-in-section">
             <div class="window-box p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-8 accent-color">LEVEL_UP_HISTORY.LOG</h2>
                <div class="space-y-6">
                    <div><p class="secondary-accent-color">2022 - PRESENT</p><h3 class="text-lg">Vellore Institute of Technology</h3><p class="text-xs secondary-text">B.TECH IN COMPUTER SCIENCE // CGPA: 8.02</p></div>
                    <div><p class="secondary-accent-color">2020 - 2022</p><h3 class="text-lg">Narayana Junior College</h3><p class="text-xs secondary-text">INTERMEDIATE (CLASS XII) // SCORE: 92.5%</p></div>
                    <div><p class="secondary-accent-color">2019 - 2020</p><h3 class="text-lg">Narayana High School</h3><p class="text-xs secondary-text">CLASS X // SCORE: 99%</p></div>
                </div>
            </div>
        </section>

        <section id="projects" class="py-20 fade-in-section">
            <h2 class="text-2xl md:text-3xl font-bold mb-8 text-center accent-color">COMPLETED_MISSIONS:</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="project-card bg-[#000030] p-4 h-56 flex flex-col items-center justify-center text-center">
                    <h3 class="text-lg font-bold secondary-accent-color">IOT RAILWAY MONITOR</h3>
                    <p class="text-xs secondary-text mt-2">Real-time fault detection system using ESP32 and cloud integration.</p>
                </div>
                <div class="project-card bg-[#000030] p-4 h-56 flex flex-col items-center justify-center text-center">
                    <h3 class="text-lg font-bold secondary-accent-color">AATC RESTAURANT APP</h3>
                    <p class="text-xs secondary-text mt-2">Responsive web app with Firebase for live order tracking.</p>
                </div>
                <div class="project-card bg-[#000030] p-4 h-56 flex flex-col items-center justify-center text-center">
                    <h3 class="text-lg font-bold secondary-accent-color">ANIME REC SYSTEM</h3>
                    <p class="text-xs secondary-text mt-2">An intuitive, genre-based anime suggestion tool built with JS.</p>
                </div>
            </div>
        </section>

        <section id="skills" class="py-20 fade-in-section">
            <div class="window-box p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-8 accent-color">SKILL_TREE.DATA</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold mb-4">TECH_SKILLS:</h3>
                        <div class="space-y-4">
                            <div><p class="mb-2 text-xs flex items-center"><span class="skill-icon mr-2"></span>C/C++</p><div class="skill-bar-container" data-skill="9"></div></div>
                            <div><p class="mb-2 text-xs flex items-center"><span class="skill-icon mr-2"></span>PYTHON</p><div class="skill-bar-container" data-skill="8"></div></div>
                            <div><p class="mb-2 text-xs flex items-center"><span class="skill-icon mr-2"></span>HTML/CSS/JS</p><div class="skill-bar-container" data-skill="9"></div></div>
                            <div><p class="mb-2 text-xs flex items-center"><span class="skill-icon mr-2"></span>REACT.JS</p><div class="skill-bar-container" data-skill="7"></div></div>
                        </div>
                    </div>
                    <div>
                         <h3 class="text-lg font-semibold mb-4">ACHIEVEMENTS:</h3>
                         <div class="space-y-4 text-xs">
                             <p class="secondary-text"><span class="secondary-accent-color">*</span> MS_AZURE_AI_FUNDAMENTALS</p>
                             <p class="secondary-text"><span class="secondary-accent-color">*</span> GOOGLE_CYBERSECURITY_FOUNDATIONS</p>
                         </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="ai-sidekick" class="py-20 fade-in-section">
            <div class="window-box p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 accent-color">AI_SIDEKICK.EXE</h2>
                <div id="ai-chat-box"></div>
                <div class="flex gap-4 mt-4">
                    <input type="text" id="ai-input" placeholder="TYPE YOUR MESSAGE HERE..." />
                    <button id="ai-send-btn" class="btn-morph text-xs"><span class="top !px-4 !py-2">SEND</span><span class="bottom"></span></button>
                </div>
            </div>
        </section>

        <section id="contact" class="py-20 text-center fade-in-section">
            <h2 class="text-2xl md:text-3xl font-bold mb-4 accent-color">CONTACT_PLAYER_1</h2>
            <p class="max-w-md mx-auto secondary-text text-xs md:text-sm leading-relaxed mb-8">OPEN TO NEW QUESTS AND COLLABORATIONS. SEND A MESSAGE TO JOIN THE PARTY.</p>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                <a href="mailto:chaitanyakrishna294@gmail.com" class="btn-morph"><span class="top">SEND_MESSAGE</span><span class="bottom"></span></a>
                <a href="#ai-sidekick" class="btn-morph"><span class="top">âœ¨ TALK TO MY AI SIDEKICK</span><span class="bottom"></span></a>
            </div>
        </section>
    </main>
    
    <footer class="py-8 text-center relative z-10">
        <div class="flex justify-center items-center space-x-6 mb-4">
            <a href="https://github.com/Chaitanyakrishna294" target="_blank" rel="noopener noreferrer" class="hover:text-accent-color transition-colors"><i data-feather="github" class="w-6 h-6"></i></a>
            <a href="https://www.linkedin.com/in/chevuru-chaitanya-krishna-reddy-bb3281274?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank" rel="noopener noreferrer" class="hover:text-accent-color transition-colors linkedin-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="4" height="12" x="2" y="9" />
                    <circle cx="4" cy="4" r="2" />
                    <path class="drop drop-1" d="M16 8a6 6 0 0 1 6 6v7h-4v-7" />
                    <path class="drop drop-2" d="M12 14a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7" />
                </svg>
            </a>
        </div>
        <p class="secondary-text text-xs">DESIGNED & BUILT BY CKR_ // 2024</p>
    </footer>

    <!-- Game Over Screen -->
    <div id="game-over-screen" class="hidden">
        <h1 class="text-3xl md:text-5xl mb-8 accent-color">THANKS FOR PLAYING!</h1>
        <div class="flex justify-center items-center space-x-6 mb-8">
            <a href="https://github.com/Chaitanyakrishna294" target="_blank" rel="noopener noreferrer" class="hover:text-accent-color transition-colors"><i data-feather="github" class="w-12 h-12"></i></a>
            <a href="https://www.linkedin.com/in/chevuru-chaitanya-krishna-reddy-bb3281274?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank" rel="noopener noreferrer" class="hover:text-accent-color transition-colors linkedin-icon">
                 <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="4" height="12" x="2" y="9" />
                    <circle cx="4" cy="4" r="2" />
                    <path class="drop drop-1" d="M16 8a6 6 0 0 1 6 6v7h-4v-7" />
                    <path class="drop drop-2" d="M12 14a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7" />
                </svg>
            </a>
        </div>
        <button id="play-again-button" class="btn-morph"><span class="top text-2xl md:text-4xl">PLAY AGAIN?</span><span class="bottom"></span></button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            feather.replace();
            setupLoadingScreen();
            startTypingAnimation();
            setupScrollAnimations();
            setupThemeToggle();
            setupScrollCharacter();
            spawnScenery();
            setupSpecialEffects();
            setupAISidekick();
            setupSkillIcons();
            setupGameOverScreen();
            setupWeather();
            spawnCollectibles();
            spawnGroundDetails();
        });

        function setupLoadingScreen() {
            const introScreen = document.getElementById('intro-screen');
            const startButton = document.getElementById('intro-start-button');
            const loadingText = document.getElementById('loading-text');
            const loadingBar = document.getElementById('loading-bar');
            const stages = ["COMPILING SKILLS...", "RENDERING PROJECTS...", "SPAWNING CHARACTER...", "READY!"];
            let stage = 0;

            const interval = setInterval(() => {
                stage++;
                if (stage <= stages.length) {
                    loadingText.innerHTML = `&gt; ${stages[stage - 1]}`;
                    loadingBar.style.width = `${(stage / stages.length) * 100}%`;
                }
                if (stage === stages.length) {
                    clearInterval(interval);
                    startButton.classList.remove('hidden');
                }
            }, 1000);

            startButton.addEventListener('click', () => {
                introScreen.classList.add('hidden');
            }, { once: true });
        }
        
        function setupThemeToggle() {
            const toggleButton = document.getElementById('theme-toggle');
            const character = document.getElementById('main-character');
            
            const currentHour = new Date().getHours();
            const isDayTime = currentHour >= 6 && currentHour < 18;
            if (isDayTime) {
                document.body.classList.add('light-mode');
                document.body.classList.remove('dark-mode');
                toggleButton.querySelector('.feather-sun').classList.add('hidden');
                toggleButton.querySelector('.feather-moon').classList.remove('hidden');
            }

            toggleButton.addEventListener('click', () => {
                character.classList.add('char-is-changing');
                document.body.classList.toggle('dark-mode');
                document.body.classList.toggle('light-mode');
                toggleButton.querySelector('.feather-sun').classList.toggle('hidden');
                toggleButton.querySelector('.feather-moon').classList.toggle('hidden');
                setupWeather();
                setTimeout(() => character.classList.remove('char-is-changing'), 500);
            });
        }

        function setupWeather() {
            const weatherLayer = document.getElementById('weather-layer');
            weatherLayer.innerHTML = '';
            const chance = Math.random();
            const isDayTime = document.body.classList.contains('light-mode');

            if (isDayTime) {
                if (chance < 0.2) {
                    for (let i = 0; i < 50; i++) {
                        const drop = document.createElement('div');
                        drop.className = 'rain-drop';
                        drop.style.left = `${Math.random() * 100}%`;
                        drop.style.animationDelay = `${Math.random()}s`;
                        weatherLayer.appendChild(drop);
                    }
                } else {
                    const sun = document.createElement('div');
                    sun.className = 'sun';
                    weatherLayer.appendChild(sun);
                }
            } else {
                 for (let i = 0; i < 100; i++) {
                    const star = document.createElement('div');
                    star.className = 'star';
                    star.style.left = `${Math.random() * 100}%`;
                    star.style.top = `${Math.random() * 100}%`;
                    star.style.animationDelay = `${Math.random() * 2}s`;
                    weatherLayer.appendChild(star);
                }
            }
        }

        function spawnCollectibles() {
            const collectibleLayer = document.getElementById('collectible-layer');
            const icons = {
                cplusplus: `<svg viewBox="0 0 128 128"><path fill="#00599c" d="M64 0L83 19L128 24L109 64L128 104L83 119L64 128L45 119L0 104L19 64L0 24L45 19Z"/><text x="64" y="78" font-size="60" fill="white" text-anchor="middle" font-family="'Press Start 2P'">C++</text></svg>`,
                python: `<svg viewBox="0 0 128 128"><path fill="#3776ab" d="M64 0L83 19L128 24L109 64L128 104L83 119L64 128L45 119L0 104L19 64L0 24L45 19Z"/><text x="64" y="78" font-size="60" fill="#ffde57" text-anchor="middle" font-family="'Press Start 2P'">Py</text></svg>`,
                js: `<svg viewBox="0 0 128 128"><path fill="#f7df1e" d="M64 0L83 19L128 24L109 64L128 104L83 119L64 128L45 119L0 104L19 64L0 24L45 19Z"/><text x="64" y="78" font-size="60" fill="black" text-anchor="middle" font-family="'Press Start 2P'">JS</text></svg>`,
                react: `<svg viewBox="0 0 128 128"><path fill="#61dafb" d="M64 0L83 19L128 24L109 64L128 104L83 119L64 128L45 119L0 104L19 64L0 24L45 19Z"/><circle cx="64" cy="64" r="15" fill="#20232a"/></svg>`,
            };
            
            const totalHeight = document.documentElement.scrollHeight;
            let i = 0;
            for (const key in icons) {
                const collectible = document.createElement('div');
                collectible.className = 'collectible';
                collectible.id = `collectible-${key}`;
                collectible.innerHTML = icons[key];
                const topPosition = (totalHeight / (Object.keys(icons).length + 1)) * (i + 1);
                collectible.style.top = `${topPosition}px`;
                collectible.style.left = `${10 + Math.random() * 80}%`;
                collectibleLayer.appendChild(collectible);
                i++;
            }
        }
        
        function spawnGroundDetails() {
            const groundDetails = document.getElementById('ground-details');
            for (let i = 0; i < 15; i++) {
                const item = document.createElement('div');
                item.className = 'ground-item';
                item.style.left = `${i * 7 + Math.random() * 5}%`;
                item.innerHTML = `
                    <div class="flower"><svg viewBox="0 0 20 30"><path d="M10 30 V15 M10 15 C0 15 5 0 10 5 C15 0 20 15 10 15" stroke="green" stroke-width="2" fill="none"/><circle cx="10" cy="5" r="3" fill="yellow"/></svg></div>
                    <div class="mushroom"><svg viewBox="0 0 20 20"><path d="M5 20 V10 H15 V20 M5 10 C5 0 15 0 15 10" fill="#9400D3" stroke="#4B0082" stroke-width="1"/></svg></div>
                `;
                groundDetails.appendChild(item);
            }
        }

        function startTypingAnimation() {
            const roles = ["BACKEND DEVELOPER", "AI ENTHUSIAST", "CLOUD ARCHITECT"];
            let roleIndex = 0, charIndex = 0;
            const el = document.getElementById('typing-text');
            function type() { if (charIndex < roles[roleIndex].length) { el.textContent += roles[roleIndex].charAt(charIndex++); setTimeout(type, 150); } else { setTimeout(erase, 2500); } }
            function erase() { if (charIndex > 0) { el.textContent = roles[roleIndex].substring(0, --charIndex); setTimeout(erase, 75); } else { roleIndex = (roleIndex + 1) % roles.length; setTimeout(type, 500); } }
            type();
        }

        function setupScrollAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        if (entry.target.id === 'skills') animateSkillBars();
                    }
                });
            }, { threshold: 0.2 });
            document.querySelectorAll('.fade-in-section').forEach(s => observer.observe(s));
        }

        function animateSkillBars() {
            document.querySelectorAll('.skill-bar-container').forEach(bar => {
                const skillLevel = parseInt(bar.dataset.skill, 10);
                if (bar.children.length !== 10) {
                    bar.innerHTML = '';
                    for (let i = 0; i < 10; i++) {
                        const block = document.createElement('div');
                        block.className = `skill-block ${i < skillLevel ? 'filled' : ''}`;
                        bar.appendChild(block);
                    }
                }
            });
        }

        function setupScrollCharacter() {
            const character = document.getElementById('main-character');
            const sceneryLayers = document.querySelectorAll('.scenery-layer');
            let lastScrollY = window.scrollY, isJumping = false;

            const performJump = () => {
                if (isJumping) return;
                isJumping = true;
                character.classList.add('jumping');
                setTimeout(() => {
                    character.classList.remove('jumping');
                    isJumping = false;
                }, 600);
            };

            window.addEventListener('scroll', () => {
                const scrollableHeight = document.documentElement.scrollHeight - window.innerHeight;
                if (scrollableHeight <= 0) return;
                const scrollPercent = window.scrollY / scrollableHeight;
                character.style.left = `${5 + scrollPercent * 85}%`;
                sceneryLayers.forEach(l => l.style.transform = `translateX(${-(scrollPercent * parseFloat(l.dataset.speed) * 100)}px)`);
                if (Math.abs(window.scrollY - lastScrollY) > 10) {
                    createPowerUpParticle(character);
                }
                lastScrollY = window.scrollY;

                const charRect = character.getBoundingClientRect();
                document.querySelectorAll('.collectible:not(.collected)').forEach(item => {
                    const itemRect = item.getBoundingClientRect();
                    if (charRect.left < itemRect.right && charRect.right > itemRect.left &&
                        charRect.top < itemRect.bottom && charRect.bottom > itemRect.top) {
                        item.classList.add('collected');
                    }
                });
            });

            window.addEventListener('keydown', (e) => { if (e.code === 'Space') performJump(); });
            document.getElementById('jump-button').addEventListener('click', performJump);
        }
        
        function createPowerUpParticle(character) {
            const particle = document.createElement('div');
            particle.className = 'power-up-particle';
            const rect = character.getBoundingClientRect();
            particle.style.left = `${rect.left + rect.width / 2 - 4}px`;
            particle.style.top = `${rect.top + rect.height / 2 - 4}px`;
            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), 500);
        }

        function spawnScenery() {
            const clouds = document.getElementById('clouds'), lightTrees = document.getElementById('light-trees'), mountains = document.getElementById('mountains'), darkTrees = document.getElementById('dark-trees');
            clouds.innerHTML = '';
            lightTrees.innerHTML = '';
            mountains.innerHTML = '';
            darkTrees.innerHTML = '';

            for (let i = 0; i < 5; i++) { const c = document.createElement('div'); c.className = 'scenery-item cloud'; c.style.cssText = `left:${Math.random()*100}%; top:${10+Math.random()*20}%; transform:scale(${.8+Math.random()*0.4}); animation-delay:${Math.random()*60}s; opacity: ${0.7 + Math.random() * 0.3}; width: 120px; height: 80px;`; c.innerHTML = `<svg viewBox="0 0 120 80" style="width:100%; height:100%; fill:rgba(255,255,255,0.9);"><g><circle cx="40" cy="40" r="20"/><circle cx="60" cy="30" r="30"/><circle cx="85" cy="45" r="25"/></g></svg>`; clouds.appendChild(c); }
            for (let i = 0; i < 10; i++) { const t = document.createElement('div'); t.className = 'scenery-item'; t.style.left = `${i*10+Math.random()*5}%`; t.style.transform = `scale(${0.9 + Math.random() * 0.2})`; t.innerHTML = `<svg viewBox="0 0 80 140" style="width:80px; height:140px;"><rect x="35" y="100" width="10" height="40" fill="#8B4513"/><path d="M40 0 L10 50 L25 50 L0 90 L30 90 L20 110 L60 110 L50 90 L80 90 L55 50 L70 50 Z" fill="#228B22"/></svg>`; lightTrees.appendChild(t); }
            for (let i = 0; i < 4; i++) { const m = document.createElement('div'); m.className = 'scenery-item'; m.style.cssText = `left:${i*25-15}%; bottom:45px; z-index:${i}; transform: scale(${1 + i*0.2})`; m.innerHTML = `<svg viewBox="0 0 300 150" style="width:400px; height:200px; fill:rgb(88, 40, 144, ${.4+i*.15})"><path d="M0 150 L75 20 L125 80 L200 10 L250 100 L300 150 Z"/></svg>`; mountains.appendChild(m); }
            for (let i = 0; i < 10; i++) { const t = document.createElement('div'); t.className = 'scenery-item'; t.style.left = `${i*10+Math.random()*5}%`; t.style.transform = `scale(${0.9 + Math.random() * 0.2})`; t.innerHTML = `<svg viewBox="0 0 60 120" style="width:60px; height:120px;"><path d="M30 120 L30 60 L10 80 L30 60 L50 80 M30 60 L20 40 L30 60 L40 40" stroke="#000" stroke-width="4" fill="none"/></svg>`; darkTrees.appendChild(t); }
        }

        function setupSpecialEffects() {
            const startButton = document.getElementById('start-button');
            startButton.addEventListener('click', (e) => {
                e.preventDefault();
                document.body.classList.add('screen-shake');
                setTimeout(() => {
                    document.body.classList.remove('screen-shake');
                    document.querySelector(startButton.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });
                }, 500);
            });
        }

        function setupSkillIcons() {
            const icons = ['&lt;/&gt;', 'ðŸ', 'âš¡ï¸', 'âš›ï¸'];
            document.querySelectorAll('.skill-icon').forEach((span, i) => span.innerHTML = icons[i] || '');
        }
        
        function setupGameOverScreen() {
            const gameOverScreen = document.getElementById('game-over-screen');
            const playAgainButton = document.getElementById('play-again-button');
            const footer = document.querySelector('footer');
            const jumpButton = document.getElementById('jump-button');

            const observer = new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting) {
                    gameOverScreen.classList.remove('hidden');
                    jumpButton.classList.add('hidden');
                    feather.replace();
                }
            }, { threshold: 1.0 });

            observer.observe(footer);

            playAgainButton.addEventListener('click', () => {
                gameOverScreen.classList.add('hidden');
                jumpButton.classList.remove('hidden');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        function setupAISidekick() {
            const aiChatBox = document.getElementById('ai-chat-box');
            const aiInput = document.getElementById('ai-input');
            const aiSendBtn = document.getElementById('ai-send-btn');
            const powerupDisplay = document.getElementById('ai-powerup-display');
            let chatHistory = [];
            
            const addMessage = (sender, message) => {
                const p = document.createElement('p');
                p.innerHTML = `<span class="${sender === 'PLAYER' ? 'accent-color' : 'secondary-accent-color'}">${sender}:</span> ${message}`;
                aiChatBox.appendChild(p);
                aiChatBox.scrollTop = aiChatBox.scrollHeight;
                return p;
            };
            
            const sendMessageToAI = async () => {
                const userMessage = aiInput.value.trim();
                if (!userMessage) return;
                addMessage('PLAYER', userMessage);
                aiInput.value = '';
                aiSendBtn.disabled = true;
                const loadingMsg = addMessage('AI_SIDEKICK', '...');
                
                const portfolioContext = `You are a retro video game AI Sidekick on Chaitanya Krishna Reddy's portfolio website. Your name is CKR_AI. Your personality is helpful, a bit quirky, and you speak like a classic 8-bit game character. Use phrases like "GREETINGS, PLAYER!", "PROCESSING...", "QUERY ACCEPTED.", "CKR's stats are impressive!", etc. Answer questions based ONLY on the following information about Chaitanya (CKR): - Summary: Motivated BTech Computer Science student with strong foundation in backend development, AI-powered applications, and cloud solutions. - Education: B.Tech in CS at VIT, Chennai (CGPA 8.02). Intermediate from Narayana Junior College (92.5%). Class X from Narayana High School (99%). - Skills: C/C++, Python, Java, SQL, HTML, CSS, React.js. - Tools: VS Code, Jupyter Notebook, Git. - Projects: 1. IoT Railway Track Monitoring: Real-time fault detection with ESP32 and cloud. 2. AATC Restaurant Website: Responsive web app with Firebase for live orders. 3. Anime Recommendation System: Genre-based suggestion tool with JS. - Certifications: Microsoft Certified Azure AI Fundamentals, Google Foundations of Cybersecurity. - Interests: Drawing and sketching. Keep your answers concise and in character. If the user asks about anything not on this list, you must politely decline and state that your purpose is only to talk about Chaitanya.`;
                chatHistory.push({ role: "user", parts: [{ text: portfolioContext + "\n\nPLAYER ASKS: " + userMessage }] });

                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyDeksZr8ejceEoVR6pGgm7ag7qiJm76rcU";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    const result = await response.json();
                    loadingMsg.remove();
                    if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                        const aiResponse = result.candidates[0].content.parts[0].text;
                        addMessage('AI_SIDEKICK', aiResponse);
                        chatHistory.push({ role: "model", parts: [{ text: aiResponse }] });
                    } else {
                        addMessage('AI_SIDEKICK', 'SYSTEM_ERROR: NO_RESPONSE.');
                    }
                } catch (error) {
                    console.error("AI Error:", error);
                    loadingMsg.remove();
                    addMessage('AI_SIDEKICK', 'CONNECTION_LOST.');
                } finally {
                    aiSendBtn.disabled = false;
                    aiInput.focus();
                }
            };
            aiSendBtn.addEventListener('click', sendMessageToAI);
            aiInput.addEventListener('keypress', e => e.key === 'Enter' && sendMessageToAI());
        }
    </script>
</body>
</html>
